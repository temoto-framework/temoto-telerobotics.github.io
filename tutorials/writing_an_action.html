

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Writing an Action &mdash; temoto_tutorials  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Utilizing the Managers" href="utilizing_the_managers.html" />
    <link rel="prev" title="Starting Temoto" href="starting_temoto.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> temoto_tutorials
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="starting_temoto.html">Starting Temoto</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Writing an Action</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#start-the-temoto-action-assistant">1) Start the TeMoto Action Assistant</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-your-semantic-frame">2) Create your semantic frame</a></li>
<li class="toctree-l2"><a class="reference internal" href="#generate-the-action-package">3) Generate the action package</a></li>
<li class="toctree-l2"><a class="reference internal" href="#modify-the-autogenerated-source">4) Modify the autogenerated source</a></li>
<li class="toctree-l2"><a class="reference internal" href="#compile-and-test-the-action">5) Compile and test the action</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="utilizing_the_managers.html">Utilizing the Managers</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">temoto_tutorials</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Writing an Action</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/writing_an_action.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="writing-an-action">
<h1>Writing an Action<a class="headerlink" href="#writing-an-action" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This tutorial assumes that you are familiar with the concept of <a class="reference external" href="../../../temoto-telerobotics.github.io/site/concepts/actions">Actions and Semantic Frames</a> in TeMoto.</p>
</div>
<p>The basis for an action can be easily generated via TeMoto Action Assistant. Since the structure of an action is defined by its semantic frame, the TeMoto Action Assistant provides the graphical interface for creating a semantic frame. Once you are happy with the semantic frame, a basis for action implementation package is generated, incuding a c++ source file.</p>
<p>For this particular tutorial, we are going to create an action that will be run when temoto_agent receives instruction:</p>
<div style="text-align:center; font-style:italic; font-weight: bold">"put the box on the table"</div><br><div class="section" id="start-the-temoto-action-assistant">
<h2>1) Start the TeMoto Action Assistant<a class="headerlink" href="#start-the-temoto-action-assistant" title="Permalink to this headline">¶</a></h2>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>roslaunch temoto_action_assistant action_assistant.launch
</pre></div>
</div>
<p>This should bring up the start screen of the action assistant, depicted in Fig. 1. If you have a feeling that the Action Assistant looks awfully similar to MoveIt! Setup Assistant, then you are correct, it’s based on it. Click on the <em>“Create New TeMoto Action Package”</em> button.</p>
<div class="figure align-center" id="id1">
<a class="reference internal image-reference" href="_images/start_screen.bmp"><img alt="_images/start_screen.bmp" src="_images/start_screen.bmp" style="width: 400px;" /></a>
<p class="caption"><span class="caption-text"><strong>Fig. 1:</strong> Start screen of the TeMoto Action Assistant</span></p>
</div>
</div>
<div class="section" id="create-your-semantic-frame">
<h2>2) Create your semantic frame<a class="headerlink" href="#create-your-semantic-frame" title="Permalink to this headline">¶</a></h2>
<p>Go to the <em>“Semantic Frame Editor”</em> tab (depicted in Fig. 2). This tab consists of 3 main sections:</p>
<blockquote>
<div><ul class="simple">
<li><strong>Semantic Frame Viewer</strong> section, which visually shows the structure of the SF.</li>
<li><strong>Item Editor</strong> section, which allows to edit the currently active item in the SF Viewer.</li>
<li><strong>Add/Remove Items</strong> section, which allows to add or remove the currently active item in the SF viewer.</li>
</ul>
</div></blockquote>
<div class="figure align-center" id="id2">
<a class="reference internal image-reference" href="_images/semantic_frame_editor_expl.bmp"><img alt="_images/semantic_frame_editor_expl.bmp" src="_images/semantic_frame_editor_expl.bmp" style="width: 450px;" /></a>
<p class="caption"><span class="caption-text"><strong>Fig. 2:</strong> Semantic Frame Editor tab</span></p>
</div>
<ul class="simple">
<li>Modify the lexical unit above the SF Viewer. In the given example, the lexical unit is <em>“put”</em>.</li>
<li>Select the <em>input</em> item of the first interface (Interface 0) and create a new subject by clicking the <em>“Add to Selected”</em> button.</li>
<li>A blank subject is created. Edit this subject via the Subject editor (first highlight the item in the SF Viewer). In the given example the type of the subject is <em>“what”</em> and the word is <em>“box”</em>.</li>
<li>Create the second subject in the same way as the first was created and edit it. In the given example the type of the second subject is <em>“where”</em> and the word is <em>“table”</em>.</li>
</ul>
</div>
<div class="section" id="generate-the-action-package">
<h2>3) Generate the action package<a class="headerlink" href="#generate-the-action-package" title="Permalink to this headline">¶</a></h2>
<p>Go to the <em>“Configuration Files”</em> tab (depicted in Fig. 3).</p>
<ul class="simple">
<li>Name the action via <em>“Action Package Name”</em> field. The names are automatically forced to follow the <a class="reference external" href="http://www.ros.org/reps/rep-0144.html">ROS package naming convention</a>. So don’t be surprised if you cannot use capital letters and whitespaces. Additionally, a prefix of <em>“ta_”</em> is added, which stands for TeMoto Action.</li>
<li>Select the directory where the action package is generated.</li>
<li>Generate the package by clicking the <em>“Generate”</em> button.</li>
</ul>
<div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="_images/generate_action.bmp"><img alt="_images/generate_action.bmp" src="_images/generate_action.bmp" style="width: 450px;" /></a>
<p class="caption"><span class="caption-text"><strong>Fig. 3:</strong> Configuration files tab</span></p>
</div>
</div>
<div class="section" id="modify-the-autogenerated-source">
<h2>4) Modify the autogenerated source<a class="headerlink" href="#modify-the-autogenerated-source" title="Permalink to this headline">¶</a></h2>
<p>Now navigate to the generated package and open the [Action Source](/temoto-telerobotics.github.io/site/concepts/actions) file with your favourite editor. For example:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> temoto_actions/ta_my_example_action/src
gedit ta_my_example_action.cpp
</pre></div>
</div>
<p>The [Action Source](/temoto-telerobotics.github.io/site/concepts/actions) file contains a bunch of things that are necessary for TeMoto, but we are going to focus on a <code class="docutils literal notranslate"><span class="pre">startInterface_0()</span></code> function. This function corresponds to the interface that is described in the SF.</p>
<p>Locate the block comment which says “YOUR CODE HERE”:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm"> * Interface 0 body</span>
<span class="cm"> */</span>
<span class="kt">void</span> <span class="nf">startInterface_0</span><span class="p">()</span>
<span class="p">{</span>
  <span class="cm">/* EXTRACTION OF INPUT SUBJECTS */</span>
  <span class="n">TTP</span><span class="o">::</span><span class="n">Subject</span> <span class="n">what_0_in</span> <span class="o">=</span> <span class="n">TTP</span><span class="o">::</span><span class="n">getSubjectByType</span><span class="p">(</span><span class="s">&quot;what&quot;</span><span class="p">,</span> <span class="n">input_subjects</span><span class="p">);</span>
  <span class="n">std</span><span class="o">::</span><span class="n">string</span>  <span class="n">what_0_word_in</span> <span class="o">=</span> <span class="n">what_0_in</span><span class="p">.</span><span class="n">words_</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

  <span class="n">TTP</span><span class="o">::</span><span class="n">Subject</span> <span class="n">where_1_in</span> <span class="o">=</span> <span class="n">TTP</span><span class="o">::</span><span class="n">getSubjectByType</span><span class="p">(</span><span class="s">&quot;where&quot;</span><span class="p">,</span> <span class="n">input_subjects</span><span class="p">);</span>
  <span class="n">std</span><span class="o">::</span><span class="n">string</span>  <span class="n">where_1_word_in</span> <span class="o">=</span> <span class="n">where_1_in</span><span class="p">.</span><span class="n">words_</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

  <span class="cm">/* * * * * * * * * * * * * * *</span>
<span class="cm">   *                           *</span>
<span class="cm">   * ===&gt; YOUR CODE HERE &lt;===  *</span>
<span class="cm">   *                           *</span>
<span class="cm">   * * * * * * * * * * * * * * */</span>

<span class="p">}</span>
</pre></div>
</div>
<p>and replace it with your arbitrary code. In this example, the input subjects <em>“box”</em> and <em>“table”</em> are printed out through <code class="docutils literal notranslate"><span class="pre">TEMOTO_INFO_STREAM</span></code> function, which is same as <code class="docutils literal notranslate"><span class="pre">ROS_INFO_STREAM</span></code> but adds a bit of debug information in front of the message.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm"> * Interface 0 body</span>
<span class="cm"> */</span>
<span class="kt">void</span> <span class="nf">startInterface_0</span><span class="p">()</span>
<span class="p">{</span>
  <span class="cm">/* EXTRACTION OF INPUT SUBJECTS */</span>
  <span class="n">TTP</span><span class="o">::</span><span class="n">Subject</span> <span class="n">what_0_in</span> <span class="o">=</span> <span class="n">TTP</span><span class="o">::</span><span class="n">getSubjectByType</span><span class="p">(</span><span class="s">&quot;what&quot;</span><span class="p">,</span> <span class="n">input_subjects</span><span class="p">);</span>
  <span class="n">std</span><span class="o">::</span><span class="n">string</span>  <span class="n">what_0_word_in</span> <span class="o">=</span> <span class="n">what_0_in</span><span class="p">.</span><span class="n">words_</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

  <span class="n">TTP</span><span class="o">::</span><span class="n">Subject</span> <span class="n">where_1_in</span> <span class="o">=</span> <span class="n">TTP</span><span class="o">::</span><span class="n">getSubjectByType</span><span class="p">(</span><span class="s">&quot;where&quot;</span><span class="p">,</span> <span class="n">input_subjects</span><span class="p">);</span>
  <span class="n">std</span><span class="o">::</span><span class="n">string</span>  <span class="n">where_1_word_in</span> <span class="o">=</span> <span class="n">where_1_in</span><span class="p">.</span><span class="n">words_</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

  <span class="cm">/*</span>
<span class="cm">   * MY CODE HERE</span>
<span class="cm">   */</span>
  <span class="n">TEMOTO_INFO_STREAM</span><span class="p">(</span><span class="s">&quot;I will put the &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">what_0_word_in</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; on the &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">where_1_word_in</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="compile-and-test-the-action">
<h2>5) Compile and test the action<a class="headerlink" href="#compile-and-test-the-action" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Compile the action.</li>
<li>Test the action by typing <em>“put the box on the table”</em> into the temoto termial. The message is printed out in the terminal where the <em>“temoto_agent”</em> was launched:</li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">[temoto_agent/TaPutBoxExample::startInterface_0]</span> <span class="pre">I</span> <span class="pre">will</span> <span class="pre">put</span> <span class="pre">the</span> <span class="pre">box</span> <span class="pre">on</span> <span class="pre">the</span> <span class="pre">table</span></code></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="utilizing_the_managers.html" class="btn btn-neutral float-right" title="Utilizing the Managers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="starting_temoto.html" class="btn btn-neutral" title="Starting Temoto" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Robert Valner.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>